<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLAMDUNKå¡ç‰‡å±•ç¤º - 1997 Cardass Masters</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #fafafa;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            font-family: Arial, sans-serif;
            color: #333;
        }
        
        .cards-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            max-width: 1000px;
        }
        
        .card {
            width: 240px;
            height: 330px;
            perspective: 1000px;
            cursor: pointer;
        }
        
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        
        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }
        
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .card-front {
            background: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .card-front img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .card-back {
            background: linear-gradient(145deg, #666, #444);
            transform: rotateY(180deg);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .card-back img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 24px;
            z-index: 1000;
        }
        
        .search-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 999;
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 500px;
            width: 90%;
        }
        
        .language-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 999;
        }
        
        .search-input {
            flex: 1;
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .search-input:focus {
            border-color: #888;
        }
        
        .search-btn {
            padding: 10px 20px;
            background: #333;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .search-btn:hover {
            background: #555;
        }
        
        .clear-btn {
            padding: 10px 15px;
            background: #666;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .clear-btn:hover {
            background: #888;
        }
        
        .language-selector {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .language-selector:focus {
            border-color: #888;
        }
        
        .card-tags {
            position: absolute;
            bottom: 10px;
            left: 10px;
            right: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            z-index: 10;
        }
        
        .card-number {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: rgba(255, 255, 255, 0.9);
            color: #1a1a2e;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            font-weight: bold;
            z-index: 11;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .tag {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
        }
        
        .zoom-icon {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 12;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s, background 0.2s;
        }
        
        .zoom-icon:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 1);
        }
        
        .zoom-icon::before {
            content: "ğŸ”";
            font-size: 16px;
        }
        
        .card.hidden {
            display: none;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            position: relative;
            max-width: 600px;
            max-height: 90vh;
            transform: scale(0.8);
            transition: transform 0.3s;
        }
        
        .modal.active .modal-content {
            transform: scale(1);
        }
        
        .modal-card {
            width: 480px;
            height: 660px;
            perspective: 1000px;
            cursor: pointer;
        }
        
        .modal-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        
        .modal-card.flipped .modal-card-inner {
            transform: rotateY(180deg);
        }
        
        .modal-card-front, .modal-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .modal-card-front {
            background: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .modal-card-front img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .modal-card-back {
            background: #f0f0f0;
            transform: rotateY(180deg);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .modal-card-back img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .modal-close {
            position: absolute;
            top: -40px;
            right: 0;
            width: 30px;
            height: 30px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 18px;
            color: #333;
            transition: background 0.2s;
        }
        
        .modal-close:hover {
            background: white;
        }
        
        .modal-close::before {
            content: "âœ•";
        }
        
        .modal-image-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            touch-action: none;
        }
        
        .modal-image-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            transform-origin: center center;
            transition: transform 0.1s ease-out;
        }
        
        .modal-image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            pointer-events: none;
        }
        
        .no-results {
            text-align: center;
            color: #666;
            font-size: 20px;
            padding: 40px;
            background: rgba(0,0,0,0.05);
            border-radius: 10px;
            margin: 20px;
        }
        
        .card-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(145deg, #f0f0f0, #e0e0e0);
            color: #666;
            position: relative;
        }
        
        .placeholder-content {
            font-size: 48px;
            opacity: 0.3;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }
        
        .load-more-container {
            text-align: center;
            margin: 40px 0;
            padding: 20px;
        }
        
        .load-more-btn {
            padding: 15px 30px;
            background: linear-gradient(145deg, #333, #555);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .load-more-btn:hover {
            background: linear-gradient(145deg, #555, #777);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .load-more-btn:active {
            transform: translateY(0);
        }
        
        .load-more-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">åŠ è½½å¡ç‰‡ä¸­...</div>
    
    <div class="search-container">
        <input type="text" class="search-input" id="searchInput" placeholder="è¾“å…¥tagæœç´¢å¡ç‰‡...">
        <button class="search-btn" onclick="searchCards()">æœç´¢</button>
        <button class="clear-btn" onclick="clearSearch()">æ¸…é™¤</button>
    </div>
    
    <div class="language-container">
        <select class="language-selector" id="languageSelector" onchange="changeLanguage()">
            <option value="zh">ä¸­æ–‡</option>
            <option value="en">EN</option>
            <option value="ja">æ—¥æœ¬èª</option>
        </select>
    </div>
    
    <div style="margin-top: 100px;">
        <div class="cards-container" id="cardsContainer">
            <!-- å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
        <div class="no-results" id="noResults" style="display: none;">
            æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å¡ç‰‡
        </div>
        <div class="load-more-container">
            <button class="load-more-btn" id="loadMoreBtn" onclick="loadCards()">åŠ è½½æ›´å¤š</button>
        </div>
    </div>
    
    <!-- æ”¾å¤§æ˜¾ç¤ºæ¨¡æ€æ¡† -->
    <div class="modal" id="cardModal">
        <div class="modal-content">
            <div class="modal-close" onclick="closeModal()"></div>
            <div class="modal-card" id="modalCard">
                <!-- æ¨¡æ€æ¡†å¡ç‰‡å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        // å¡ç‰‡æ€»æ•° - æ ¹æ®å®é™…å›¾ç‰‡æ•°é‡è°ƒæ•´
        const TOTAL_CARDS = 140;
        
        // å¤šè¯­è¨€æ–‡æœ¬
        const translations = {
            zh: {
                searchPlaceholder: "è¾“å…¥tagæœç´¢å¡ç‰‡...",
                searchBtn: "æœç´¢",
                clearBtn: "æ¸…é™¤",
                loading: "åŠ è½½å¡ç‰‡ä¸­...",
                noResults: "æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å¡ç‰‡",
                cardFront: "æ­£é¢",
                cardBack: "èƒŒé¢",
                imageError: "æ— æ³•åŠ è½½å¡ç‰‡",
                loadMore: "åŠ è½½æ›´å¤š"
            },
            en: {
                searchPlaceholder: "Search cards by tag...",
                searchBtn: "Search",
                clearBtn: "Clear",
                loading: "Loading cards...",
                noResults: "No matching cards found",
                cardFront: "Front",
                cardBack: "Back",
                imageError: "Unable to load card",
                loadMore: "Load More"
            },
            ja: {
                searchPlaceholder: "ã‚¿ã‚°ã§ã‚«ãƒ¼ãƒ‰ã‚’æ¤œç´¢...",
                searchBtn: "æ¤œç´¢",
                clearBtn: "ã‚¯ãƒªã‚¢",
                loading: "ã‚«ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã¿ä¸­...",
                noResults: "ä¸€è‡´ã™ã‚‹ã‚«ãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“",
                cardFront: "è¡¨",
                cardBack: "è£",
                imageError: "ã‚«ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“",
                loadMore: "ã‚‚ã£ã¨èª­ã¿è¾¼ã‚€"
            }
        };
        
        // å½“å‰è¯­è¨€
        let currentLanguage = 'zh';
        
        // å¡ç‰‡tagæ•°æ®ï¼ˆå¤šè¯­è¨€ï¼‰
        const cardTags = {
            zh: {
                1: ["ä¸»è§’", "æ¨±æœ¨èŠ±é“"],
                2: ["ä¸»è§’", "æµå·æ«"],
                3: ["ä¸»è§’", "èµ¤æœ¨åˆšå®ª"],
                4: ["ä¸»è§’", "å®«åŸè‰¯ç”°"],
                5: ["ä¸»è§’", "ä¸‰äº•å¯¿"],
                6: ["æ¹˜åŒ—", "é˜Ÿé•¿"],
                7: ["æ¹˜åŒ—", "å¾—åˆ†æ‰‹"],
                8: ["æ¹˜åŒ—", "æ§çƒåå«"],
                9: ["æ¹˜åŒ—", "ä¸‰åˆ†å°„æ‰‹"],
                10: ["æ¹˜åŒ—", "ç¯®æ¿ç‹"],
                11: ["æµ·å—", "ç‰§ç»…ä¸€"],
                12: ["æµ·å—", "ç¥å®—ä¸€éƒ"],
                13: ["æµ·å—", "æ¸…ç”°ä¿¡é•¿"],
                14: ["æµ·å—", "é«˜ç ‚ä¸€é©¬"],
                15: ["æµ·å—", "æ­¦è—¤æ­£"],
                16: ["ç¿”é˜³", "è—¤çœŸå¥å¸"],
                17: ["ç¿”é˜³", "èŠ±å½¢é€"],
                18: ["ç¿”é˜³", "æ°¸é‡æ»¡"],
                19: ["ç¿”é˜³", "é•¿è°·å·ä¸€å¿—"],
                20: ["ç¿”é˜³", "ä¼Šè—¤å“"],
                21: ["é™µå—", "ä»™é“å½°"],
                22: ["é™µå—", "é±¼ä½çº¯"],
                23: ["é™µå—", "ç¦ç”°å‰å…†"],
                24: ["é™µå—", "è¶Šé‡å®æ˜"],
                25: ["é™µå—", "æ± ä¸Šäº®äºŒ"],
                26: ["ä¸°ç‰", "å—çƒˆ"],
                27: ["ä¸°ç‰", "å²¸æœ¬å®ç†"],
                28: ["ä¸°ç‰", "æ¿ä»“å¤§äºŒéƒ"],
                29: ["ä¸°ç‰", "çŸ¢å¶‹äº¬å¹³"],
                30: ["ä¸°ç‰", "å²©ç”°ä¸‰ç§‹"],
                31: ["å±±ç‹", "æ²³ç”°é›…å²"],
                32: ["å±±ç‹", "æ³½åŒ—è£æ²»"],
                33: ["å±±ç‹", "é‡è¾¹å°†å®"],
                34: ["å±±ç‹", "æ¾æœ¬ç¨”"],
                35: ["å±±ç‹", "æ·±æ´¥ä¸€æˆ"],
                36: ["æ•™ç»ƒ", "å®‰è¥¿å…‰ä¹‰"],
                37: ["æ•™ç»ƒ", "é«˜å¤´åŠ›"],
                38: ["æ•™ç»ƒ", "ç”°å†ˆèŒ‚ä¸€"],
                39: ["æ•™ç»ƒ", "å ‚æœ¬äº”éƒ"],
                40: ["æ•™ç»ƒ", "ç›¸ç”°å½¦ä¸€"],
                41: ["ç»ç†", "èµ¤æœ¨æ™´å­"],
                42: ["ç»ç†", "æ¾äº•ç¨”"],
                43: ["ç»ç†", "å²›æ‘å¶å­"],
                44: ["ç»ç†", "å°æš®"],
                45: ["ç»ç†", "ç¯®çƒé˜Ÿç»ç†"],
                46: ["å‹æƒ…", "å›¢é˜Ÿ"],
                47: ["å‹æƒ…", "åŠªåŠ›"],
                48: ["å‹æƒ…", "æˆé•¿"],
                49: ["å‹æƒ…", "é’æ˜¥"],
                50: ["å‹æƒ…", "æ¢¦æƒ³"],
                51: ["æ¯”èµ›", "ç»ƒä¹ èµ›"],
                52: ["æ¯”èµ›", "å¿å¤§ä¼š"],
                53: ["æ¯”èµ›", "å…¨å›½å¤§èµ›"],
                54: ["æ¯”èµ›", "å†³èµ›"],
                55: ["æ¯”èµ›", "å…³é”®æ—¶åˆ»"],
                56: ["æŠ€æœ¯", "çŒç¯®"],
                57: ["æŠ€æœ¯", "ä¸‰åˆ†çƒ"],
                58: ["æŠ€æœ¯", "ç›–å¸½"],
                59: ["æŠ€æœ¯", "æŠ¢æ–­"],
                60: ["æŠ€æœ¯", "è¿çƒ"],
                61: ["å›å¿†", "è®­ç»ƒ"],
                62: ["å›å¿†", "ä¼‘æ¯å®¤"],
                63: ["å›å¿†", "æ¯”èµ›æ—¥"],
                64: ["å›å¿†", "åº†ç¥"],
                65: ["å›å¿†", "æŒ‘æˆ˜"],
                66: ["ç»å…¸", "å°è¯"],
                67: ["ç»å…¸", "åœºæ™¯"],
                68: ["ç»å…¸", "ç¬é—´"],
                69: ["ç»å…¸", "å¯¹å†³"],
                70: ["ç»å…¸", "é€†è¢­"],
                71: ["ç‰¹æ®Š", "ç¨€æœ‰"],
                72: ["ç‰¹æ®Š", "é™é‡"],
                73: ["ç‰¹æ®Š", "ç­¾å"],
                74: ["ç‰¹æ®Š", "çè—"],
                75: ["ç‰¹æ®Š", "é»„é‡‘"]
            },
            en: {
                1: ["Protagonist", "Hanamichi"],
                2: ["Protagonist", "Kaede"],
                3: ["Protagonist", "Takenori"],
                4: ["Protagonist", "Mitsui"],
                5: ["Protagonist", "Ryota"],
                6: ["Shohoku", "Captain"],
                7: ["Shohoku", "Scorer"],
                8: ["Shohoku", "PointGuard"],
                9: ["Shohoku", "Shooter"],
                10: ["Shohoku", "Rebounder"],
                11: ["Ryozan", "Akira"],
                12: ["Ryozan", "Kenji"],
                13: ["Ryozan", "Sinji"],
                14: ["Ryozan", "Kazuma"],
                15: ["Ryozan", "Tadashi"],
                16: ["Shoyo", "Kenji"],
                17: ["Shoyo", "Toru"],
                18: ["Shoyo", "Mitsuru"],
                19: ["Shoyo", "Kazushi"],
                20: ["Shoyo", "Suguru"],
                21: ["Ryonan", "Toru"],
                22: ["Ryonan", "Jun"],
                23: ["Ryonan", "Kiyoshi"],
                24: ["Ryonan", "Hiroaki"],
                25: ["Ryonan", "Ryoji"],
                26: ["Toyotama", "Akira"],
                27: ["Toyotama", "Masaharu"],
                28: ["Toyotama", "Daijiro"],
                29: ["Toyotama", "Kyosuke"],
                30: ["Toyotama", "Mikihisa"],
                31: ["Sannoh", "Masashi"],
                32: ["Sannoh", "Eiji"],
                33: ["Sannoh", "Masahiro"],
                34: ["Sannoh", "Minoru"],
                35: ["Sannoh", "Kazunari"],
                36: ["Coach", "Anzai"],
                37: ["Coach", "Takashi"],
                38: ["Coach", "Moichi"],
                39: ["Coach", "Goro"],
                40: ["Coach", "Hikoichi"],
                41: ["Manager", "Haruko"],
                42: ["Manager", "Minoru"],
                43: ["Manager", "Yoko"],
                44: ["Manager", "Kogure"],
                45: ["Manager", "TeamManager"],
                46: ["Friendship", "Team"],
                47: ["Friendship", "Effort"],
                48: ["Friendship", "Growth"],
                49: ["Friendship", "Youth"],
                50: ["Friendship", "Dream"],
                51: ["Match", "Practice"],
                52: ["Match", "Prefectural"],
                53: ["Match", "National"],
                54: ["Match", "Final"],
                55: ["Match", "Critical"],
                56: ["Skill", "Dunk"],
                57: ["Skill", "ThreePoint"],
                58: ["Skill", "Block"],
                59: ["Skill", "Steal"],
                60: ["Skill", "Dribble"],
                61: ["Memory", "Training"],
                62: ["Memory", "LockerRoom"],
                63: ["Memory", "GameDay"],
                64: ["Memory", "Celebration"],
                65: ["Memory", "Challenge"],
                66: ["Classic", "Line"],
                67: ["Classic", "Scene"],
                68: ["Classic", "Moment"],
                69: ["Classic", "Duel"],
                70: ["Classic", "Comeback"],
                71: ["Special", "Rare"],
                72: ["Special", "Limited"],
                73: ["Special", "Autograph"],
                74: ["Special", "Collection"],
                75: ["Special", "Gold"]
            },
            ja: {
                1: ["ä¸»äººå…¬", "æ¡œæœ¨èŠ±é“"],
                2: ["ä¸»äººå…¬", "æµå·æ¥“"],
                3: ["ä¸»äººå…¬", "èµ¤æœ¨å‰›æ†²"],
                4: ["ä¸»äººå…¬", "å®®åŸãƒªãƒ§ãƒ¼ã‚¿"],
                5: ["ä¸»äººå…¬", "ä¸‰äº•å¯¿"],
                6: ["æ¹˜åŒ—", "ä¸»å°†"],
                7: ["æ¹˜åŒ—", "å¾—ç‚¹å±‹"],
                8: ["æ¹˜åŒ—", "ãƒã‚¤ãƒ³ãƒˆã‚¬ãƒ¼ãƒ‰"],
                9: ["æ¹˜åŒ—", "ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼"],
                10: ["æ¹˜åŒ—", "ãƒªãƒã‚¦ãƒ³ãƒ€ãƒ¼"],
                11: ["æµ·å—", "ç‰§ç´³ä¸€"],
                12: ["æµ·å—", "ç¥å®—ä¸€éƒ"],
                13: ["æµ·å—", "æ¸…ç”°ä¿¡é•·"],
                14: ["æµ·å—", "é«˜ç ‚ä¸€é¦¬"],
                15: ["æµ·å—", "æ­¦è—¤æ­£"],
                16: ["ç¿”é™½", "è—¤çœŸå¥å¸"],
                17: ["ç¿”é™½", "èŠ±å½¢é€"],
                18: ["ç¿”é™½", "æ°¸é‡æº€"],
                19: ["ç¿”é™½", "é•·è°·å·ä¸€å¿—"],
                20: ["ç¿”é™½", "ä¼Šè—¤å“"],
                21: ["é™µå—", "ä»™é“å½°"],
                22: ["é™µå—", "é­šä½ç´”"],
                23: ["é™µå—", "ç¦ç”°å‰å…†"],
                24: ["é™µå—", "è¶Šé‡å®æ˜"],
                25: ["é™µå—", "æ± ä¸Šäº®äºŒ"],
                26: ["è±Šç‰", "å—çƒˆ"],
                27: ["è±Šç‰", "å²¸æœ¬å®Ÿç†"],
                28: ["è±Šç‰", "æ¿å€‰å¤§äºŒéƒ"],
                29: ["è±Šç‰", "çŸ¢å¶‹äº¬å¹³"],
                30: ["è±Šç‰", "å²©ç”°ä¸‰ç§‹"],
                31: ["å±±ç‹", "æ²³ç”°é›…å²"],
                32: ["å±±ç‹", "æ²¢åŒ—æ „æ²»"],
                33: ["å±±ç‹", "é‡è¾ºå°†å®"],
                34: ["å±±ç‹", "æ¾æœ¬ç¨”"],
                35: ["å±±ç‹", "æ·±æ´¥ä¸€æˆ"],
                36: ["ç›£ç£", "å®‰è¥¿å…‰ç¾©"],
                37: ["ç›£ç£", "é«˜é ­åŠ›"],
                38: ["ç›£ç£", "ç”°å²¡èŒ‚ä¸€"],
                39: ["ç›£ç£", "å ‚æœ¬äº”éƒ"],
                40: ["ç›£ç£", "ç›¸ç”°å½¦ä¸€"],
                41: ["ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼", "èµ¤æœ¨æ™´å­"],
                42: ["ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼", "æ¾äº•ç¨”"],
                43: ["ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼", "å³¶æ‘è‘‰å­"],
                44: ["ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼", "æœ¨æš®"],
                45: ["ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼", "ãƒã‚¹ã‚±éƒ¨ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼"],
                46: ["å‹æƒ…", "ãƒãƒ¼ãƒ "],
                47: ["å‹æƒ…", "åŠªåŠ›"],
                48: ["å‹æƒ…", "æˆé•·"],
                49: ["å‹æƒ…", "é’æ˜¥"],
                50: ["å‹æƒ…", "å¤¢"],
                51: ["è©¦åˆ", "ç·´ç¿’è©¦åˆ"],
                52: ["è©¦åˆ", "çœŒå¤§ä¼š"],
                53: ["è©¦åˆ", "å…¨å›½å¤§ä¼š"],
                54: ["è©¦åˆ", "æ±ºå‹"],
                55: ["è©¦åˆ", "é‡è¦å ´é¢"],
                56: ["æŠ€è¡“", "ãƒ€ãƒ³ã‚¯"],
                57: ["æŠ€è¡“", "ã‚¹ãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ"],
                58: ["æŠ€è¡“", "ãƒ–ãƒ­ãƒƒã‚¯"],
                59: ["æŠ€è¡“", "ã‚¹ãƒ†ã‚£ãƒ¼ãƒ«"],
                60: ["æŠ€è¡“", "ãƒ‰ãƒªãƒ–ãƒ«"],
                61: ["æ€ã„å‡º", "ç·´ç¿’"],
                62: ["æ€ã„å‡º", "ãƒ­ãƒƒã‚«ãƒ¼ãƒ«ãƒ¼ãƒ "],
                63: ["æ€ã„å‡º", "è©¦åˆæ—¥"],
                64: ["æ€ã„å‡º", "ç¥è³€"],
                65: ["æ€ã„å‡º", "æŒ‘æˆ¦"],
                66: ["åå ´é¢", "ã‚»ãƒªãƒ•"],
                67: ["åå ´é¢", "ã‚·ãƒ¼ãƒ³"],
                68: ["åå ´é¢", "ç¬é–“"],
                69: ["åå ´é¢", "å¯¾æ±º"],
                70: ["åå ´é¢", "é€†è»¢"],
                71: ["ç‰¹æ®Š", "ãƒ¬ã‚¢"],
                72: ["ç‰¹æ®Š", "é™å®š"],
                73: ["ç‰¹æ®Š", "ã‚µã‚¤ãƒ³"],
                74: ["ç‰¹æ®Š", "ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³"],
                75: ["ç‰¹æ®Š", "ã‚´ãƒ¼ãƒ«ãƒ‰"]
            }
        };
        
        // ç”Ÿæˆé»˜è®¤tagsï¼ˆå¯¹äºæ²¡æœ‰å®šä¹‰çš„å¡ç‰‡ï¼‰
        function generateDefaultTags(cardNumber, lang) {
            const tags = [];
            const tagMap = {
                zh: ["æ¹˜åŒ—", "æµ·å—", "ç¿”é˜³", "é™µå—", "ä¸°ç‰", "å±±ç‹", "æ•™ç»ƒ", "ç»ç†", "å‹æƒ…", "æ¯”èµ›", "æŠ€æœ¯", "å›å¿†", "ç»å…¸", "ç‰¹æ®Š", "å…¶ä»–"],
                en: ["Shohoku", "Ryozan", "Shoyo", "Ryonan", "Toyotama", "Sannoh", "Coach", "Manager", "Friendship", "Match", "Skill", "Memory", "Classic", "Special", "Other"],
                ja: ["æ¹˜åŒ—", "æµ·å—", "ç¿”é™½", "é™µå—", "è±Šç‰", "å±±ç‹", "ç›£ç£", "ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼", "å‹æƒ…", "è©¦åˆ", "æŠ€è¡“", "æ€ã„å‡º", "åå ´é¢", "ç‰¹æ®Š", "ãã®ä»–"]
            };
            
            const limitedMap = {
                zh: ["é™é‡", "çè—"],
                en: ["Limited", "Collection"],
                ja: ["é™å®š", "ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³"]
            };
            
            if (cardNumber <= 10) tags.push(tagMap[lang][0]);
            else if (cardNumber <= 15) tags.push(tagMap[lang][1]);
            else if (cardNumber <= 20) tags.push(tagMap[lang][2]);
            else if (cardNumber <= 25) tags.push(tagMap[lang][3]);
            else if (cardNumber <= 30) tags.push(tagMap[lang][4]);
            else if (cardNumber <= 35) tags.push(tagMap[lang][5]);
            else if (cardNumber <= 40) tags.push(tagMap[lang][6]);
            else if (cardNumber <= 45) tags.push(tagMap[lang][7]);
            else if (cardNumber <= 50) tags.push(tagMap[lang][8]);
            else if (cardNumber <= 55) tags.push(tagMap[lang][9]);
            else if (cardNumber <= 60) tags.push(tagMap[lang][10]);
            else if (cardNumber <= 65) tags.push(tagMap[lang][11]);
            else if (cardNumber <= 70) tags.push(tagMap[lang][12]);
            else if (cardNumber <= 75) tags.push(tagMap[lang][13]);
            else tags.push(tagMap[lang][14]);
            
            if (cardNumber % 5 === 0) tags.push(limitedMap[lang][0]);
            if (cardNumber % 10 === 0) tags.push(limitedMap[lang][1]);
            
            return tags;
        }
        
        // è·å–å¡ç‰‡tags
        function getCardTags(cardNumber) {
            return cardTags[currentLanguage][cardNumber] || generateDefaultTags(cardNumber, currentLanguage);
        }
        
        // è¯­è¨€åˆ‡æ¢å‡½æ•°
        function changeLanguage() {
            const selector = document.getElementById('languageSelector');
            currentLanguage = selector.value;
            
            // æ›´æ–°ç•Œé¢æ–‡æœ¬
            const t = translations[currentLanguage];
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            document.querySelector('.search-btn').textContent = t.searchBtn;
            document.querySelector('.clear-btn').textContent = t.clearBtn;
            document.getElementById('noResults').textContent = t.noResults;
            
            // æ›´æ–°åŠ è½½æ›´å¤šæŒ‰é’®æ–‡æœ¬
            updateLoadMoreButton();
            
            // é‡æ–°ç”Ÿæˆå¡ç‰‡
            regenerateCards();
        }
        
        // é‡æ–°ç”Ÿæˆå¡ç‰‡
        function regenerateCards() {
            const container = document.getElementById('cardsContainer');
            container.innerHTML = '';
            currentPage = 1;
            isLoading = false;
            generateCards();
        }
        
        // å»¶è¿ŸåŠ è½½é…ç½®
        const CARDS_PER_PAGE = 12;
        let currentPage = 1;
        let isLoading = false;
        
        // ç”Ÿæˆå¡ç‰‡
        async function generateCards() {
            const container = document.getElementById('cardsContainer');
            const loadingElement = document.getElementById('loading');
            
            try {
                // å…ˆç”Ÿæˆæ‰€æœ‰å¡ç‰‡çš„å ä½ç¬¦ï¼Œä½†ä¸åŠ è½½å›¾ç‰‡
                for (let i = 1; i <= TOTAL_CARDS; i++) {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.setAttribute('data-tags', getCardTags(i).join(','));
                    card.setAttribute('data-card-number', i);
                    card.setAttribute('data-loaded', 'false'); // æ ‡è®°æ˜¯å¦å·²åŠ è½½
                    
                    // ç”Ÿæˆtag HTML
                    const tags = getCardTags(i);
                    const tagHtml = tags.map(tag => `<span class="tag">${tag}</span>`).join('');
                    
                    // åˆå§‹æ—¶ä½¿ç”¨å ä½ç¬¦ï¼Œä¸åŠ è½½å®é™…å›¾ç‰‡
                    card.innerHTML = `
                        <div class="card-inner">
                            <div class="card-front">
                                <div class="card-placeholder" data-card-number="${i}" data-side="A">
                                    <div class="placeholder-content">ğŸ€</div>
                                    <div class="card-number">${i}</div>
                                    <div class="card-tags">${tagHtml}</div>
                                    <div class="zoom-icon" onclick="openModal(${i}, event)"></div>
                                </div>
                            </div>
                            <div class="card-back">
                                <div class="card-placeholder" data-card-number="${i}" data-side="B">
                                    <div class="placeholder-content">ğŸ€</div>
                                    <div class="card-number">${i}</div>
                                    <div class="card-tags">${tagHtml}</div>
                                    <div class="zoom-icon" onclick="openModal(${i}, event)"></div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                    card.addEventListener('click', function() {
                        this.classList.toggle('flipped');
                    });
                    
                    container.appendChild(card);
                }
                
                // åŠ è½½ç¬¬ä¸€æ‰¹å¡ç‰‡
                await loadCards();
                
            } catch (error) {
                console.error('ç”Ÿæˆå¡ç‰‡æ—¶å‡ºé”™:', error);
            } finally {
                loadingElement.style.display = 'none';
            }
        }
        
        // åŠ è½½æŒ‡å®šèŒƒå›´çš„å¡ç‰‡
        async function loadCards() {
            if (isLoading) return;
            isLoading = true;
            
            const startIndex = (currentPage - 1) * CARDS_PER_PAGE;
            const endIndex = Math.min(startIndex + CARDS_PER_PAGE, TOTAL_CARDS);
            
            const cards = document.querySelectorAll('.card');
            
            for (let i = startIndex; i < endIndex; i++) {
                if (i >= cards.length) break;
                
                const card = cards[i];
                const cardNumber = parseInt(card.getAttribute('data-card-number'));
                const isLoaded = card.getAttribute('data-loaded') === 'true';
                
                if (!isLoaded) {
                    await loadCardImages(card, cardNumber);
                    card.setAttribute('data-loaded', 'true');
                }
            }
            
            currentPage++;
            isLoading = false;
            
            // æ˜¾ç¤ºåŠ è½½æ›´å¤šæŒ‰é’®æˆ–æ£€æµ‹æ»šåŠ¨
            updateLoadMoreButton();
        }
        
        // åŠ è½½å•ä¸ªå¡ç‰‡çš„å›¾ç‰‡
        async function loadCardImages(card, cardNumber) {
            const frontPlaceholder = card.querySelector('[data-side="A"]');
            const backPlaceholder = card.querySelector('[data-side="B"]');
            
            // æ„å»ºå›¾ç‰‡è·¯å¾„
            const frontImagePath = `images/card/1997CardassMasters/${cardNumber}_A.jpg`;
            const backImagePath = `images/card/1997CardassMasters/${cardNumber}_B.jpg`;
            
            // ä¸ºæ¯å¼ å¡ç‰‡æ·»åŠ å”¯ä¸€æ—¶é—´æˆ³é˜²æ­¢ç¼“å­˜
            const timestamp = Date.now() + cardNumber;
            
            // ç”Ÿæˆtag HTML
            const tags = getCardTags(cardNumber);
            const tagHtml = tags.map(tag => `<span class="tag">${tag}</span>`).join('');
            
            // æ›¿æ¢æ­£é¢å ä½ç¬¦ä¸ºå®é™…å›¾ç‰‡
            if (frontPlaceholder) {
                frontPlaceholder.outerHTML = `
                    <img src="${frontImagePath}?t=${timestamp}" alt="å¡ç‰‡${cardNumber}æ­£é¢" loading="lazy" onerror="handleImageError(this, ${cardNumber}, 'A')">
                    <div class="card-number">${cardNumber}</div>
                    <div class="card-tags">${tagHtml}</div>
                    <div class="zoom-icon" onclick="openModal(${cardNumber}, event)"></div>
                `;
            }
            
            // æ›¿æ¢èƒŒé¢å ä½ç¬¦ä¸ºå®é™…å›¾ç‰‡
            if (backPlaceholder) {
                backPlaceholder.outerHTML = `
                    <img src="${backImagePath}?t=${timestamp}" alt="å¡ç‰‡${cardNumber}èƒŒé¢" loading="lazy" onerror="handleImageError(this, ${cardNumber}, 'B')">
                    <div class="card-number">${cardNumber}</div>
                    <div class="card-tags">${tagHtml}</div>
                    <div class="zoom-icon" onclick="openModal(${cardNumber}, event)"></div>
                `;
            }
        }
        
        // æ›´æ–°"åŠ è½½æ›´å¤š"æŒ‰é’®çŠ¶æ€
        function updateLoadMoreButton() {
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            const loadedCount = document.querySelectorAll('.card[data-loaded="true"]').length;
            const t = translations[currentLanguage];
            
            if (loadMoreBtn) {
                if (loadedCount >= TOTAL_CARDS) {
                    loadMoreBtn.style.display = 'none';
                } else {
                    loadMoreBtn.style.display = 'block';
                    loadMoreBtn.textContent = `${t.loadMore} (${loadedCount}/${TOTAL_CARDS})`;
                }
            }
            
            // æ¨¡æ‹ŸåŠ è½½å»¶è¿Ÿï¼Œå®é™…ä½¿ç”¨æ—¶å¯ä»¥ç§»é™¤
            await new Promise(resolve => setTimeout(resolve, 1500));
            
        } catch (error) {
            console.error('ç”Ÿæˆå¡ç‰‡æ—¶å‡ºé”™:', error);
        } finally {
            loadingElement.style.display = 'none';
        }
    }
        
        // å›¾ç‰‡åŠ è½½é”™è¯¯å¤„ç†
        function handleImageError(imgElement, cardNumber, side) {
            const t = translations[currentLanguage];
            console.warn(`${t.imageError} ${cardNumber}_${side}.jpg`);
            
            // å°è¯•åŠ è½½é»˜è®¤å›¾ç‰‡
            const defaultImagePath = 'images/card/1997CardassMasters/default.png';
            const defaultImg = new Image();
            
            defaultImg.onload = function() {
                // é»˜è®¤å›¾ç‰‡åŠ è½½æˆåŠŸï¼Œæ›¿æ¢å‡ºé”™å›¾ç‰‡
                imgElement.src = defaultImagePath;
                imgElement.alt = `é»˜è®¤${side === 'A' ? t.cardFront : t.cardBack}`;
                
                // å¦‚æœæ˜¯èƒŒé¢å›¾ç‰‡ç¼ºå¤±ï¼Œæ·»åŠ ä¸€ä¸ªèƒŒé¢æ ‡è¯†
                if (side === 'B') {
                    const backIndicator = document.createElement('div');
                    backIndicator.style.position = 'absolute';
                    backIndicator.style.top = '10px';
                    backIndicator.style.left = '10px';
                    backIndicator.style.background = 'rgba(255,255,255,0.9)';
                    backIndicator.style.color = '#ff4757';
                    backIndicator.style.padding = '5px 10px';
                    backIndicator.style.borderRadius = '15px';
                    backIndicator.style.fontSize = '12px';
                    backIndicator.style.fontWeight = 'bold';
                    backIndicator.style.zIndex = '13';
                    backIndicator.textContent = 'é»˜è®¤èƒŒé¢';
                    
                    imgElement.parentNode.appendChild(backIndicator);
                }
            };
            
            defaultImg.onerror = function() {
                // é»˜è®¤å›¾ç‰‡ä¹ŸåŠ è½½å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
                const placeholder = document.createElement('div');
                placeholder.style.width = '100%';
                placeholder.style.height = '100%';
                placeholder.style.display = 'flex';
                placeholder.style.justifyContent = 'center';
                placeholder.style.alignItems = 'center';
                placeholder.style.backgroundColor = side === 'A' ? '#2c3e50' : '#ff4757';
                placeholder.style.color = 'white';
                placeholder.style.fontSize = '24px';
                placeholder.style.fontWeight = 'bold';
                
                const sideText = side === 'A' ? t.cardFront : t.cardBack;
                placeholder.textContent = `${t.imageError} ${cardNumber} ${sideText}`;
                
                // æ›¿æ¢å‡ºé”™å›¾ç‰‡
                imgElement.parentNode.replaceChild(placeholder, imgElement);
            };
            
            // å°è¯•åŠ è½½é»˜è®¤å›¾ç‰‡
            defaultImg.src = defaultImagePath;
        }
        
        // æœç´¢å¡ç‰‡
        function searchCards() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput.value.toLowerCase().trim();
            const cards = document.querySelectorAll('.card');
            const noResults = document.getElementById('noResults');
            
            if (searchTerm === '') {
                clearSearch();
                return;
            }
            
            let visibleCount = 0;
            
            cards.forEach(card => {
                const tags = card.getAttribute('data-tags').toLowerCase();
                const cardNumber = card.getAttribute('data-card-number');
                
                // æ£€æŸ¥æ˜¯å¦åŒ¹é…tagæˆ–å¡å·
                const matchesTag = tags.includes(searchTerm);
                const matchesNumber = cardNumber.includes(searchTerm);
                
                if (matchesTag || matchesNumber) {
                    card.classList.remove('hidden');
                    visibleCount++;
                } else {
                    card.classList.add('hidden');
                }
            });
            
            // æ˜¾ç¤º/éšè—æ— ç»“æœæç¤º
            if (visibleCount === 0) {
                noResults.style.display = 'block';
            } else {
                noResults.style.display = 'none';
            }
        }
        
        // æ¸…é™¤æœç´¢
        function clearSearch() {
            const searchInput = document.getElementById('searchInput');
            const cards = document.querySelectorAll('.card');
            const noResults = document.getElementById('noResults');
            
            searchInput.value = '';
            cards.forEach(card => {
                card.classList.remove('hidden');
            });
            noResults.style.display = 'none';
        }
        
        // ç¼©æ”¾çŠ¶æ€
        let scale = 1;
        let lastDistance = 0;
        let isZooming = false;
        
        // æ‰“å¼€æ¨¡æ€æ¡†
        function openModal(cardNumber, event) {
            event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œé¿å…è§¦å‘å¡ç‰‡ç¿»è½¬
            
            const modal = document.getElementById('cardModal');
            const modalCard = document.getElementById('modalCard');
            const tags = getCardTags(cardNumber);
            const tagHtml = tags.map(tag => `<span class="tag">${tag}</span>`).join('');
            
            const frontImagePath = `images/card/1997CardassMasters/${cardNumber}_A.jpg`;
            const backImagePath = `images/card/1997CardassMasters/${cardNumber}_B.jpg`;
            
            // ä¸ºæ¨¡æ€æ¡†å›¾ç‰‡æ·»åŠ æ—¶é—´æˆ³
            const modalTimestamp = Date.now() + cardNumber;
            
            modalCard.innerHTML = `
                <div class="modal-card-inner">
                    <div class="modal-card-front">
                        <div class="modal-image-container">
                            <div class="modal-image-wrapper">
                                <img src="${frontImagePath}?t=${modalTimestamp}" alt="å¡ç‰‡${cardNumber}æ­£é¢" loading="lazy" onerror="handleModalImageError(this, ${cardNumber}, 'A')">
                            </div>
                        </div>
                        <div class="card-number">${cardNumber}</div>
                        <div class="card-tags">${tagHtml}</div>
                    </div>
                    <div class="modal-card-back">
                        <div class="modal-image-container">
                            <div class="modal-image-wrapper">
                                <img src="${backImagePath}?t=${modalTimestamp}" alt="å¡ç‰‡${cardNumber}èƒŒé¢" loading="lazy" onerror="handleModalImageError(this, ${cardNumber}, 'B')">
                            </div>
                        </div>
                        <div class="card-number">${cardNumber}</div>
                        <div class="card-tags">${tagHtml}</div>
                    </div>
                </div>
            `;
            
            // é‡ç½®ç¼©æ”¾çŠ¶æ€
            scale = 1;
            lastDistance = 0;
            isZooming = false;
            
            // æ·»åŠ ç¿»è½¬äº‹ä»¶
            modalCard.addEventListener('click', function() {
                this.classList.toggle('flipped');
            });
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
            
            // è®¾ç½®ç¼©æ”¾äº‹ä»¶ç›‘å¬
            setupZoomListeners();
        }
        
        // è®¾ç½®ç¼©æ”¾äº‹ä»¶ç›‘å¬å™¨
        function setupZoomListeners() {
            const imageContainers = document.querySelectorAll('.modal-image-container');
            
            imageContainers.forEach(container => {
                const wrapper = container.querySelector('.modal-image-wrapper');
                
                // è§¦æ‘¸å¼€å§‹
                container.addEventListener('touchstart', handleTouchStart, { passive: false });
                
                // è§¦æ‘¸ç§»åŠ¨
                container.addEventListener('touchmove', handleTouchMove, { passive: false });
                
                // è§¦æ‘¸ç»“æŸ
                container.addEventListener('touchend', handleTouchEnd, { passive: false });
                
                // é¼ æ ‡æ»šè½®ç¼©æ”¾
                container.addEventListener('wheel', handleWheel, { passive: false });
                
                // åŒå‡»é‡ç½®ç¼©æ”¾
                container.addEventListener('dblclick', resetZoom);
            });
        }
        
        // å¤„ç†è§¦æ‘¸å¼€å§‹
        function handleTouchStart(e) {
            if (e.touches.length === 2) {
                e.preventDefault();
                isZooming = true;
                lastDistance = getDistance(e.touches[0], e.touches[1]);
            }
        }
        
        // å¤„ç†è§¦æ‘¸ç§»åŠ¨
        function handleTouchMove(e) {
            if (e.touches.length === 2 && isZooming) {
                e.preventDefault();
                
                const currentDistance = getDistance(e.touches[0], e.touches[1]);
                const scaleDelta = currentDistance / lastDistance;
                
                scale = Math.min(Math.max(scale * scaleDelta, 1), 5); // é™åˆ¶ç¼©æ”¾èŒƒå›´ 1-5
                lastDistance = currentDistance;
                
                applyZoom(e.currentTarget);
            }
        }
        
        // å¤„ç†è§¦æ‘¸ç»“æŸ
        function handleTouchEnd(e) {
            isZooming = false;
        }
        
        // å¤„ç†é¼ æ ‡æ»šè½®
        function handleWheel(e) {
            e.preventDefault();
            
            const delta = e.deltaY > 0 ? 0.9 : 1.1;
            scale = Math.min(Math.max(scale * delta, 1), 5); // é™åˆ¶ç¼©æ”¾èŒƒå›´ 1-5
            
            applyZoom(e.currentTarget);
        }
        
        // åº”ç”¨ç¼©æ”¾
        function applyZoom(container) {
            const wrapper = container.querySelector('.modal-image-wrapper');
            wrapper.style.transform = `scale(${scale})`;
        }
        
        // é‡ç½®ç¼©æ”¾
        function resetZoom(e) {
            scale = 1;
            applyZoom(e.currentTarget);
        }
        
        // è®¡ç®—ä¸¤ç‚¹è·ç¦»
        function getDistance(touch1, touch2) {
            const dx = touch1.clientX - touch2.clientX;
            const dy = touch1.clientY - touch2.clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }
        
        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            const modal = document.getElementById('cardModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto'; // æ¢å¤æ»šåŠ¨
            
            // é‡ç½®ç¼©æ”¾çŠ¶æ€
            scale = 1;
            lastDistance = 0;
            isZooming = false;
        }
        
        // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
        document.getElementById('cardModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // ESCé”®å…³é—­æ¨¡æ€æ¡†
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
        
        // æ¨¡æ€æ¡†å›¾ç‰‡é”™è¯¯å¤„ç†
        function handleModalImageError(imgElement, cardNumber, side) {
            const t = translations[currentLanguage];
            console.warn(`${t.imageError} ${cardNumber}_${side}.jpg`);
            
            // å°è¯•åŠ è½½é»˜è®¤å›¾ç‰‡
            const defaultImagePath = 'images/card/1997CardassMasters/default.png';
            const defaultImg = new Image();
            
            defaultImg.onload = function() {
                // é»˜è®¤å›¾ç‰‡åŠ è½½æˆåŠŸï¼Œæ›¿æ¢å‡ºé”™å›¾ç‰‡
                imgElement.src = defaultImagePath;
                imgElement.alt = `é»˜è®¤${side === 'A' ? t.cardFront : t.cardBack}`;
                
                // å¦‚æœæ˜¯èƒŒé¢å›¾ç‰‡ç¼ºå¤±ï¼Œæ·»åŠ ä¸€ä¸ªèƒŒé¢æ ‡è¯†
                if (side === 'B') {
                    const backIndicator = document.createElement('div');
                    backIndicator.style.position = 'absolute';
                    backIndicator.style.top = '10px';
                    backIndicator.style.left = '10px';
                    backIndicator.style.background = 'rgba(255,255,255,0.9)';
                    backIndicator.style.color = '#ff4757';
                    backIndicator.style.padding = '5px 10px';
                    backIndicator.style.borderRadius = '15px';
                    backIndicator.style.fontSize = '12px';
                    backIndicator.style.fontWeight = 'bold';
                    backIndicator.style.zIndex = '13';
                    backIndicator.textContent = 'é»˜è®¤èƒŒé¢';
                    
                    imgElement.parentNode.appendChild(backIndicator);
                }
            };
            
            defaultImg.onerror = function() {
                // é»˜è®¤å›¾ç‰‡ä¹ŸåŠ è½½å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
                const placeholder = document.createElement('div');
                placeholder.style.width = '100%';
                placeholder.style.height = '100%';
                placeholder.style.display = 'flex';
                placeholder.style.justifyContent = 'center';
                placeholder.style.alignItems = 'center';
                placeholder.style.backgroundColor = side === 'A' ? '#2c3e50' : '#ff4757';
                placeholder.style.color = 'white';
                placeholder.style.fontSize = '36px';
                placeholder.style.fontWeight = 'bold';
                
                const sideText = side === 'A' ? t.cardFront : t.cardBack;
                placeholder.textContent = `${t.imageError} ${cardNumber} ${sideText}`;
                
                imgElement.parentNode.replaceChild(placeholder, imgElement);
            };
            
            // å°è¯•åŠ è½½é»˜è®¤å›¾ç‰‡
            defaultImg.src = defaultImagePath;
        }
        
        // æ»šåŠ¨æ£€æµ‹åŠ è½½æ›´å¤š
        function setupScrollDetection() {
            let scrollTimeout;
            
            window.addEventListener('scroll', function() {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(function() {
                    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    const windowHeight = window.innerHeight;
                    const documentHeight = document.documentElement.scrollHeight;
                    
                    // å½“æ»šåŠ¨åˆ°è·ç¦»åº•éƒ¨200pxæ—¶è‡ªåŠ¨åŠ è½½æ›´å¤š
                    if (scrollTop + windowHeight >= documentHeight - 200) {
                        const loadedCount = document.querySelectorAll('.card[data-loaded="true"]').length;
                        if (loadedCount < TOTAL_CARDS && !isLoading) {
                            loadCards();
                        }
                    }
                }, 100); // é˜²æŠ–å¤„ç†ï¼Œé¿å…é¢‘ç¹è§¦å‘
            });
        }
        
        // DOMåŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            generateCards();
            
            // è®¾ç½®æ»šåŠ¨æ£€æµ‹
            setupScrollDetection();
            
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchCards();
                }
            });
        });
    </script>
</body>
</html>